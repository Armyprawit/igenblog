function createBanner(e,t,n,a){if(state=!0,$("#console").animate({bottom:"0px"},800),create=!1,window.XMLHttpRequest)create=new XMLHttpRequest,create.overrideMimeType&&create.overrideMimeType("text/html");else if(window.ActiveXObject)try{create=new ActiveXObject("Msxml2.XMLHTTP")}catch(o){try{create=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){}}if(!create)return alert("Cannot create XMLHTTP instance"),!1;var s="process/process-banner-create.php",r="title="+e+"&image="+t+"&link="+n+"&zone="+a;create.open("POST",s,!0),create.setRequestHeader("Content-type","application/x-www-form-urlencoded"),create.send(r),create.onreadystatechange=function(){3==create.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==create.readyState&&($("#console").fadeIn(200).html(create.responseText),$("#console").delay(3e3).animate({bottom:"-50px"},500),modeListBanner(0),toCreateBanner())}}function editBanner(e,t,n,a,o){if(state=!0,showLiveView("close"),$("#console").animate({bottom:"0px"},800),edit=!1,window.XMLHttpRequest)edit=new XMLHttpRequest,edit.overrideMimeType&&edit.overrideMimeType("text/html");else if(window.ActiveXObject)try{edit=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){try{edit=new ActiveXObject("Microsoft.XMLHTTP")}catch(s){}}if(!edit)return alert("Cannot edit XMLHTTP instance"),!1;var r="process/process-banner-edit.php",i="id="+e+"&title="+t+"&image="+n+"&link="+a+"&zone="+o;edit.open("POST",r,!0),edit.setRequestHeader("Content-type","application/x-www-form-urlencoded"),edit.send(i),edit.onreadystatechange=function(){3==edit.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==edit.readyState&&($("#console").fadeIn(200).html(edit.responseText),$("#console").delay(3e3).animate({bottom:"-50px"},400),toSelectBanner(e),modeListBanner(0))}}function statusBanner(e,t){if(state=!0,$("#loading-"+e).fadeIn(200).html('<i class="fa fa-spinner fa-spin"></i>'),status_s=!1,window.XMLHttpRequest)status_s=new XMLHttpRequest,status_s.overrideMimeType&&status_s.overrideMimeType("text/html");else if(window.ActiveXObject)try{status_s=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{status_s=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!status_s)return alert("Cannot status_s XMLHTTP instance"),!1;var a="process/process-banner-status.php",o="id="+e+"&stat="+t;status_s.open("POST",a,!0),status_s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),status_s.send(o),status_s.onreadystatechange=function(){3==status_s.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==status_s.readyState&&($("#status-"+e).html(status_s.responseText),$("#loading-"+e).fadeIn(200).html(""))}}function modeListBanner(e){if(state=!0,$("#list").fadeOut(100),mode=!1,window.XMLHttpRequest)mode=new XMLHttpRequest,mode.overrideMimeType&&mode.overrideMimeType("text/html");else if(window.ActiveXObject)try{mode=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{mode=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!mode)return alert("Cannot mode XMLHTTP instance"),!1;var n="process/mode-banner.php",a="type="+e;mode.open("POST",n,!0),mode.setRequestHeader("Content-type","application/x-www-form-urlencoded"),mode.send(a),mode.onreadystatechange=function(){3==mode.readyState,4==mode.readyState&&$("#list").fadeIn(200).html(mode.responseText)},index=5}function searchPhoto(e){if(state=!1,search=!1,window.XMLHttpRequest)search=new XMLHttpRequest,search.overrideMimeType&&search.overrideMimeType("text/html");else if(window.ActiveXObject)try{search=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{search=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!search)return alert("Cannot search XMLHTTP instance"),!1;var n="process/process-photo-search.php",a="q="+e;search.open("POST",n,!0),search.setRequestHeader("Content-type","application/x-www-form-urlencoded"),search.send(a),search.onreadystatechange=function(){3==search.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==search.readyState&&$("#list").html(search.responseText)},index=5,console.log("set index = 5"),""==e&&(modeListPhoto(),state=!0)}function loadingBanner(e,t){if(state=!0,loading=!1,$("#loadingProcess").slideDown("fast"),window.XMLHttpRequest)loading=new XMLHttpRequest,loading.overrideMimeType&&loading.overrideMimeType("text/html");else if(window.ActiveXObject)try{loading=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{loading=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!loading)return alert("Cannot loading XMLHTTP instance"),!1;var a="process/process-banner-loading.php",o="zone="+e+"&start="+t;loading.open("POST",a,!0),loading.setRequestHeader("Content-type","application/x-www-form-urlencoded"),loading.send(o),loading.onreadystatechange=function(){3==loading.readyState,4==loading.readyState&&($("#list").append(loading.responseText),console.log("start:"+t),index+=5,$("#loadingProcess").slideUp("fast"))}}function toSelectBanner(e){if($("#result").fadeOut(100),document.getElementById("loading-"+e).innerHTML='<i class="fa fa-spinner fa-spin"></i>',editForm=!1,window.XMLHttpRequest)editForm=new XMLHttpRequest,editForm.overrideMimeType&&editForm.overrideMimeType("text/html");else if(window.ActiveXObject)try{editForm=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{editForm=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!editForm)return alert("Cannot editForm XMLHTTP instance"),!1;var n="process/edit-banner.php",a="id="+e;editForm.open("POST",n,!0),editForm.setRequestHeader("Content-type","application/x-www-form-urlencoded"),editForm.send(a),editForm.onreadystatechange=function(){3==editForm.readyState,4==editForm.readyState&&(document.getElementById("loading-"+e).innerHTML="",$("#result").fadeIn(200).html(editForm.responseText))}}function deleteBanner(e){if(state=!0,showLiveView("close"),$("#console").animate({bottom:"0px"},800),deletes=!1,window.XMLHttpRequest)deletes=new XMLHttpRequest,deletes.overrideMimeType&&deletes.overrideMimeType("text/html");else if(window.ActiveXObject)try{deletes=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{deletes=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!deletes)return alert("Cannot delete XMLHTTP instance"),!1;var n="process/process-banner-delete.php",a="id="+e;deletes.open("POST",n,!0),deletes.setRequestHeader("Content-type","application/x-www-form-urlencoded"),deletes.send(a),deletes.onreadystatechange=function(){3==deletes.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==deletes.readyState&&($("#console").fadeIn(200).html(deletes.responseText),$("#console").delay(3e3).animate({bottom:"-50px"},500),$("#"+e).slideUp(400))}}function toCreateBanner(){if(state=!0,createForm=!1,window.XMLHttpRequest)createForm=new XMLHttpRequest,createForm.overrideMimeType&&createForm.overrideMimeType("text/html");else if(window.ActiveXObject)try{createForm=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{createForm=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}if(!createForm)return alert("Cannot createForm XMLHTTP instance"),!1;var t="process/process-banner-createform.php",n="id=0";createForm.open("POST",t,!0),createForm.setRequestHeader("Content-type","application/x-www-form-urlencoded"),createForm.send(n),createForm.onreadystatechange=function(){3==createForm.readyState,4==createForm.readyState&&($("#result").fadeIn(200).html(createForm.responseText),modeListBanner(0))}}var create=!1,edit=!1,createForm=!1,editForm=!1,example=!1,loading=!1,mode=!1,search=!1,status_s=!1,index=5,state=!0,deletes=!1;$(window).scroll(function(){$(window).scrollTop()+$(window).height()>=$(document).height()-50&&state&&loadingBanner($("#categoryMode").val(),index)});
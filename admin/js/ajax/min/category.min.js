function showCategory(e){if($("#result").fadeOut(100),category=!1,window.XMLHttpRequest)category=new XMLHttpRequest,category.overrideMimeType&&category.overrideMimeType("text/html");else if(window.ActiveXObject)try{category=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{category=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!category)return alert("Cannot create XMLHTTP instance"),!1;var a="process/edit-category.php",o="id="+e;category.open("POST",a,!0),category.setRequestHeader("Content-type","application/x-www-form-urlencoded"),category.send(o),category.onreadystatechange=function(){3==category.readyState&&(document.getElementById("loading-"+e).innerHTML='<i class="fa fa-spinner fa-spin"></i>'),4==category.readyState&&(document.getElementById("loading-"+e).innerHTML="",$("#result").fadeIn(200).html(category.responseText))}}function modeCategory(e){if($(".item").removeClass("active"),$("#option-item-"+e).addClass("active"),mode=!1,window.XMLHttpRequest)mode=new XMLHttpRequest,mode.overrideMimeType&&mode.overrideMimeType("text/html");else if(window.ActiveXObject)try{mode=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{mode=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!mode)return alert("Cannot create XMLHTTP instance"),!1;var a="process/mode-category.php",o="mode="+e;mode.open("POST",a,!0),mode.setRequestHeader("Content-type","application/x-www-form-urlencoded"),mode.send(o),mode.onreadystatechange=function(){3==mode.readyState,4==mode.readyState&&$("#list").fadeIn(200).html(mode.responseText)}}function formCategory(e,t,a,o,r,s,c){if($("#console").fadeIn(300),form=!1,window.XMLHttpRequest)form=new XMLHttpRequest,form.overrideMimeType&&form.overrideMimeType("text/html");else if(window.ActiveXObject)try{form=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{form=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){}}if(!form)return alert("Cannot create XMLHTTP instance"),!1;var i="id="+t+"&title="+a+"&url="+o+"&description="+r+"&keyword="+s+"&image="+c;if("edit"==e)var d="process/process-category-edit.php";else if("create"==e)var d="process/process-category-create.php";form.open("POST",d,!0),form.setRequestHeader("Content-type","application/x-www-form-urlencoded"),form.send(i),form.onreadystatechange=function(){3==form.readyState&&(document.getElementById("console").innerHTML='<i class="fa fa-spinner fa-spin"></i>'),4==form.readyState&&($("#console").fadeIn(200).html(form.responseText),$("#console").delay(1200).fadeOut(300),"edit"==e?showCategory(t):"create"==e&&toCreateCategory(),modeCategory(1))}}function searchCategory(e){if(search=!1,window.XMLHttpRequest)search=new XMLHttpRequest,search.overrideMimeType&&search.overrideMimeType("text/html");else if(window.ActiveXObject)try{search=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{search=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!search)return alert("Cannot create XMLHTTP instance"),!1;var a="process/process-category-search.php",o="q="+e;search.open("POST",a,!0),search.setRequestHeader("Content-type","application/x-www-form-urlencoded"),search.send(o),search.onreadystatechange=function(){3==search.readyState,4==search.readyState&&$("#list").fadeIn(200).html(search.responseText)}}function statusCategory(e,t){if(state=!0,$("#console").animate({bottom:"0px"},800),status_s=!1,window.XMLHttpRequest)status_s=new XMLHttpRequest,status_s.overrideMimeType&&status_s.overrideMimeType("text/html");else if(window.ActiveXObject)try{status_s=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{status_s=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){}}if(!status_s)return alert("Cannot status_s XMLHTTP instance"),!1;var o="process/process-category-status.php",r="id="+e+"&stat="+t;status_s.open("POST",o,!0),status_s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),status_s.send(r),status_s.onreadystatechange=function(){3==status_s.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==status_s.readyState&&($("#console").fadeIn(200).html(status_s.responseText),$("#console").delay(3e3).animate({bottom:"-50px"},500),modeCategory(1))}}function toCreateCategory(){modeCategory(1),$("#result").load("html/category-form.php")}var category=!1,mode=!1,form=!1,search=!1,status_s=!1;
function showCategory(e){if($("#result").fadeOut(100),category=!1,window.XMLHttpRequest)category=new XMLHttpRequest,category.overrideMimeType&&category.overrideMimeType("text/html");else if(window.ActiveXObject)try{category=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{category=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!category)return alert("Cannot create XMLHTTP instance"),!1;var s="process/edit-category.php",a="id="+e;category.open("POST",s,!0),category.setRequestHeader("Content-type","application/x-www-form-urlencoded"),category.send(a),category.onreadystatechange=function(){3==category.readyState&&(document.getElementById("loading-"+e).innerHTML='<i class="fa fa-spinner fa-spin"></i>'),4==category.readyState&&(document.getElementById("loading-"+e).innerHTML="",$("#result").fadeIn(200).html(category.responseText))}}function modeCategory(e){if($(".item").removeClass("active"),$("#option-item-"+e).addClass("active"),mode=!1,window.XMLHttpRequest)mode=new XMLHttpRequest,mode.overrideMimeType&&mode.overrideMimeType("text/html");else if(window.ActiveXObject)try{mode=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{mode=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!mode)return alert("Cannot create XMLHTTP instance"),!1;var s="process/mode-category.php",a="mode="+e;mode.open("POST",s,!0),mode.setRequestHeader("Content-type","application/x-www-form-urlencoded"),mode.send(a),mode.onreadystatechange=function(){3==mode.readyState,4==mode.readyState&&$("#list").fadeIn(200).html(mode.responseText)}}function formCategory(e,t,s,a,o,r,n){if($("#console").fadeIn(300),form=!1,window.XMLHttpRequest)form=new XMLHttpRequest,form.overrideMimeType&&form.overrideMimeType("text/html");else if(window.ActiveXObject)try{form=new ActiveXObject("Msxml2.XMLHTTP")}catch(c){try{form=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}if(!form)return alert("Cannot create XMLHTTP instance"),!1;var i="id="+t+"&title="+s+"&url="+a+"&description="+o+"&keyword="+r+"&image="+n;if("edit"==e)var d="process/process-category-edit.php";else if("create"==e)var d="process/process-category-create.php";form.open("POST",d,!0),form.setRequestHeader("Content-type","application/x-www-form-urlencoded"),form.send(i),form.onreadystatechange=function(){3==form.readyState&&(document.getElementById("console").innerHTML='<i class="fa fa-spinner fa-spin"></i>'),4==form.readyState&&($("#console").fadeIn(200).html(form.responseText),$("#console").delay(1200).fadeOut(300),"edit"==e?showCategory(t):"create"==e&&toCreateCategory(),modeCategory(1))}}function searchCategory(e){if(search=!1,window.XMLHttpRequest)search=new XMLHttpRequest,search.overrideMimeType&&search.overrideMimeType("text/html");else if(window.ActiveXObject)try{search=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{search=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!search)return alert("Cannot create XMLHTTP instance"),!1;var s="process/process-category-search.php",a="q="+e;search.open("POST",s,!0),search.setRequestHeader("Content-type","application/x-www-form-urlencoded"),search.send(a),search.onreadystatechange=function(){3==search.readyState,4==search.readyState&&$("#list").fadeIn(200).html(search.responseText)}}function deleteCategory(e){if(state=!0,showLiveView("close"),$("#console").animate({bottom:"0px"},800),deletes=!1,window.XMLHttpRequest)deletes=new XMLHttpRequest,deletes.overrideMimeType&&deletes.overrideMimeType("text/html");else if(window.ActiveXObject)try{deletes=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{deletes=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!deletes)return alert("Cannot delete XMLHTTP instance"),!1;var s="process/process-category-delete.php",a="id="+e;deletes.open("POST",s,!0),deletes.setRequestHeader("Content-type","application/x-www-form-urlencoded"),deletes.send(a),deletes.onreadystatechange=function(){3==deletes.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==deletes.readyState&&($("#console").fadeIn(200).html(deletes.responseText),$("#console").delay(3e3).animate({bottom:"-50px"},500),$("#"+e).slideUp(400))}}function statusCategory(e,t){if(state=!0,status_s=!1,window.XMLHttpRequest)status_s=new XMLHttpRequest,status_s.overrideMimeType&&status_s.overrideMimeType("text/html");else if(window.ActiveXObject)try{status_s=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){try{status_s=new ActiveXObject("Microsoft.XMLHTTP")}catch(s){}}if(!status_s)return alert("Cannot status_s XMLHTTP instance"),!1;var a="process/process-category-status.php",o="id="+e+"&stat="+t;status_s.open("POST",a,!0),status_s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),status_s.send(o),status_s.onreadystatechange=function(){3==status_s.readyState&&$("#console").html('<i class="fa fa-spinner fa-spin"></i> รอสักครู่...'),4==status_s.readyState&&$("#status-"+e).fadeIn(200).html(status_s.responseText)}}function toCreateCategory(){modeCategory(1),$("#result").load("html/category-form.php")}var category=!1,mode=!1,form=!1,search=!1,status_s=!1,deletes=!1;